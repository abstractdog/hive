PREHOOK: query: drop table if exists item_1
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table if exists item_1
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table item_1 (i_category_id int, i_item_sk int) stored as ORC
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@item_1
POSTHOOK: query: create table item_1 (i_category_id int, i_item_sk int) stored as ORC
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@item_1
PREHOOK: query: insert into item_1 values (1,1), (2,2)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@item_1
POSTHOOK: query: insert into item_1 values (1,1), (2,2)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@item_1
POSTHOOK: Lineage: item_1.i_category_id SCRIPT []
POSTHOOK: Lineage: item_1.i_item_sk SCRIPT []
PREHOOK: query: drop table if exists store_sales_1
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table if exists store_sales_1
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table store_sales_1 (ss_item_sk int) partitioned by (ss_store_sk int) stored as ORC
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@store_sales_1
POSTHOOK: query: create table store_sales_1 (ss_item_sk int) partitioned by (ss_store_sk int) stored as ORC
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@store_sales_1
PREHOOK: query: insert into store_sales_1 partition(ss_store_sk=1) values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18),(19),(20),(21),(22),(23),(24),(25),(26),(27),(28),(29),(30),(31),(32),(33),(34),(35),(36),(37),(38),(39),(40),(41),(42),(43),(44),(45),(46),(47),(48),(49),(50),(51),(52),(53),(54),(55),(56),(57),(58),(59),(60),(61),(62),(63),(64),(65),(66),(67),(68),(69),(70),(71),(72),(73),(74),(75),(76),(77),(78),(79),(80),(81),(82),(83),(84),(85),(86),(87),(88),(89),(90),(91),(92),(93),(94),(95),(96),(97),(98),(99),(100)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@store_sales_1@ss_store_sk=1
POSTHOOK: query: insert into store_sales_1 partition(ss_store_sk=1) values (1),(2),(3),(4),(5),(6),(7),(8),(9),(10),(11),(12),(13),(14),(15),(16),(17),(18),(19),(20),(21),(22),(23),(24),(25),(26),(27),(28),(29),(30),(31),(32),(33),(34),(35),(36),(37),(38),(39),(40),(41),(42),(43),(44),(45),(46),(47),(48),(49),(50),(51),(52),(53),(54),(55),(56),(57),(58),(59),(60),(61),(62),(63),(64),(65),(66),(67),(68),(69),(70),(71),(72),(73),(74),(75),(76),(77),(78),(79),(80),(81),(82),(83),(84),(85),(86),(87),(88),(89),(90),(91),(92),(93),(94),(95),(96),(97),(98),(99),(100)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@store_sales_1@ss_store_sk=1
POSTHOOK: Lineage: store_sales_1 PARTITION(ss_store_sk=1).ss_item_sk SCRIPT []
PREHOOK: query: drop table if exists store_1
PREHOOK: type: DROPTABLE
POSTHOOK: query: drop table if exists store_1
POSTHOOK: type: DROPTABLE
PREHOOK: query: create table store_1 (s_store_sk int) stored as ORC
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@store_1
POSTHOOK: query: create table store_1 (s_store_sk int) stored as ORC
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@store_1
PREHOOK: query: insert into store_1 values (1)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@store_1
POSTHOOK: query: insert into store_1 values (1)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@store_1
POSTHOOK: Lineage: store_1.s_store_sk SCRIPT []
Warning: Map Join MAPJOIN[30][bigTable=?] in task 'Map 1' is a cross product
PREHOOK: query: select i_category_id,count(1)
from item_1
join store_sales_1 on i_item_sk  = ss_item_sk
join store_1 on s_store_sk  = ss_store_sk
where i_item_sk = -1
group by rollup(i_category_id)
PREHOOK: type: QUERY
PREHOOK: Input: default@item_1
PREHOOK: Input: default@store_1
PREHOOK: Input: default@store_sales_1
PREHOOK: Input: default@store_sales_1@ss_store_sk=1
PREHOOK: Output: hdfs://### HDFS PATH ###
POSTHOOK: query: select i_category_id,count(1)
from item_1
join store_sales_1 on i_item_sk  = ss_item_sk
join store_1 on s_store_sk  = ss_store_sk
where i_item_sk = -1
group by rollup(i_category_id)
POSTHOOK: type: QUERY
POSTHOOK: Input: default@item_1
POSTHOOK: Input: default@store_1
POSTHOOK: Input: default@store_sales_1
POSTHOOK: Input: default@store_sales_1@ss_store_sk=1
POSTHOOK: Output: hdfs://### HDFS PATH ###
